# Telegram Bot - FastAPI Version 4.6

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–ª—è –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ–≥–æ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞!**

## –í–µ—Ä—Å–∏—è 4.6 (12.11.2025)

‚ú® **–†–µ—à–µ–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞ –ø–æ—Ç–µ—Ä–∏ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ —Ä–µ—Å—Ç–∞—Ä—Ç–µ:**

- üìÅ **–ü—É—Ç—å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:** `./storage` –≤–º–µ—Å—Ç–æ `/data` (persists –ø–æ—Å–ª–µ —Ä–µ—Å—Ç–∞—Ä—Ç–∞)
- üîí **–ê—Ç–æ–º–∞—Ä–Ω–∞—è –∑–∞–ø–∏—Å—å:** –í—Å–µ —Ñ–∞–π–ª—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è —á–µ—Ä–µ–∑ `.tmp` —Ñ–∞–π–ª—ã (–∫–∞–∫ –≤ —Å—Ç–∞—Ä–æ–º –±–æ—Ç–µ)
- üíæ **–ó–∞—â–∏—Ç–∞ –æ—Ç –∫–æ—Ä—Ä—É–ø—Ü–∏–∏:** –ï—Å–ª–∏ —Å–±–æ–π –≤–æ –≤—Ä–µ–º—è –∑–∞–ø–∏—Å–∏ ‚Äî –¥–∞–Ω–Ω—ã–µ –Ω–µ –ø–æ–≤—Ä–µ–∂–¥–∞—é—Ç—Å—è
- ‚úÖ **–í—Å–µ –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è** –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–∏—Å–∞

## –ö–ª—é—á–µ–≤—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è v4.6

### 1. –ü–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
```python
# –ë–´–õ–û:
DATA_STORAGE = os.getenv('DATA_STORAGE', '/data')  # ‚Üê —Ç–µ—Ä—è–µ—Ç—Å—è –ø—Ä–∏ —Ä–µ—Å—Ç–∞—Ä—Ç–µ

# –°–¢–ê–õ–û:
DATA_STORAGE = os.getenv('DATA_STORAGE', './storage')  # ‚Üê —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è!
```

### 2. –ê—Ç–æ–º–∞—Ä–Ω–∞—è –∑–∞–ø–∏—Å—å —Ñ–∞–π–ª–æ–≤
```python
# –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –≤—Ä–µ–º–µ–Ω–Ω—ã–π —Ñ–∞–π–ª:
tmp_path = path + ".tmp"
write_to_tmp(tmp_path)
os.replace(tmp_path, path)  # ‚Üê –∞—Ç–æ–º–∞—Ä–Ω–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è
```

### 3. –ó–∞—â–∏—â—ë–Ω–Ω–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫
```python
save_metrics_atomic(symbol, data)
# ‚Üí –ø–∏—à–µ—Ç –≤ BTCUSDT.json.tmp
# ‚Üí –∑–∞—Ç–µ–º –∞—Ç–æ–º–∞—Ä–Ω–æ –∑–∞–º–µ–Ω—è–µ—Ç BTCUSDT.json
# ‚Üí –µ—Å–ª–∏ —Å–±–æ–π = —Å—Ç–∞—Ä—ã–π —Ñ–∞–π–ª –Ω–µ –ø–æ–≤—Ä–µ–∂–¥–∞–µ—Ç—Å—è
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞

```
./storage/
‚îú‚îÄ‚îÄ pairs.txt           # —Å–ø–∏—Å–æ–∫ –ø–∞—Ä (–∞—Ç–æ–º–∞—Ä–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ)
‚îú‚îÄ‚îÄ ETHUSDT.json        # –º–µ—Ç—Ä–∏–∫–∏ ETHUSDT
‚îú‚îÄ‚îÄ BTCUSDT.json        # –º–µ—Ç—Ä–∏–∫–∏ BTCUSDT
‚îî‚îÄ‚îÄ BNBUSDT.json        # –º–µ—Ç—Ä–∏–∫–∏ BNBUSDT
```

## –ì–∞—Ä–∞–Ω—Ç–∏–∏ –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏

‚úÖ –î–∞–Ω–Ω—ã–µ **–Ω–µ —Ç–µ—Ä—è—é—Ç—Å—è** –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ —Å–µ—Ä–≤–∏—Å–∞
‚úÖ –î–∞–Ω–Ω—ã–µ **–Ω–µ –∫–æ—Ä—Ä—É–ø—Ç–∏—Ä—É—é—Ç—Å—è** –ø—Ä–∏ —Å–±–æ–µ –∑–∞–ø–∏—Å–∏
‚úÖ –ê—Ç–æ–º–∞—Ä–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É—é—Ç —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å
‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –≤–µ–∑–¥–µ: Docker, VPS, Render.com, –ª–æ–∫–∞–ª—å–Ω–æ

## –ö–æ–º–∞–Ω–¥—ã

- `/coins PAIR1 PAIR2` ‚Äî –¥–æ–±–∞–≤–∏—Ç—å –ø–∞—Ä—ã
- `/now` ‚Äî —Å–æ–±—Ä–∞—Ç—å –º–µ—Ç—Ä–∏–∫–∏
- `/data` ‚Äî —Å–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤
- `/data export all` ‚Äî –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Ñ–∞–π–ª—ã
- `/data delete all` ‚Äî –æ—á–∏—Å—Ç–∏—Ç—å —Ö—Ä–∞–Ω–∏–ª–∏—â–µ

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT
