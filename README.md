# Telegram Bot - FastAPI Version 4.1

Telegram-–±–æ—Ç –Ω–∞ Python —Å FastAPI, Uvicorn –∏ –º–æ–¥—É–ª–µ–º —Å–±–æ—Ä–∞ –º–µ—Ç—Ä–∏–∫

## –í–µ—Ä—Å–∏–∏

### v4.1 (12.11.2025)
- ‚ú® –ù–æ–≤—ã–π –º–æ–¥—É–ª—å `metrics.py` –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–ø–∏—Å–∫–æ–º —Ç–æ—Ä–≥–æ–≤—ã—Ö –ø–∞—Ä
- üìä –ö–æ–º–∞–Ω–¥–∞ `/coins` –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–∞—Ä –¥–ª—è —Å–±–æ—Ä–∞ –º–µ—Ç—Ä–∏–∫
- üíæ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–∞—Ä –≤ —Ñ–∞–π–ª `pairs.txt` –≤ STORAGE_DIR
- üîÑ –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –ø–∞—Ä (–≤–µ—Ä—Ö–Ω–∏–π —Ä–µ–≥–∏—Å—Ç—Ä, —É–¥–∞–ª–µ–Ω–∏–µ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤)
- üöÄ FastAPI + Uvicorn –¥–ª—è –ª—É—á—à–µ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### v3.1 (12.11.2025)
- üöÄ FastAPI + Uvicorn –≤–º–µ—Å—Ç–æ Flask
- üì° –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—á–∞—è –≤–µ—Ä—Å–∏—è

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Python 3.9+
- –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –¥–µ–ø–ª–æ–π

### –õ–æ–∫–∞–ª—å–Ω–æ

```bash
pip install -r requirements.txt
python main.py
# –∏–ª–∏
uvicorn main:app --host 0.0.0.0 --port 8000
```

### –ù–∞ Render.com

- **Build Command**: `pip install -r requirements.txt`
- **Start Command**: `uvicorn main:app --host 0.0.0.0 --port $PORT`

### Environment Variables

- `BOT_TOKEN` - —Ç–æ–∫–µ–Ω –±–æ—Ç–∞
- `ADMIN_CHAT_ID` - ID –∞–¥–º–∏–Ω–∞
- `WEBHOOK_BASE` - URL (–Ω–∞–ø—Ä–∏–º–µ—Ä: `https://your-app.onrender.com`)
- `DATA_STORAGE` - —Ö—Ä–∞–Ω–∏–ª–∏—â–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä: `/var/data`)

## –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞

### `/start`
–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ

### `/coins <pair1> <pair2> ...`
–î–æ–±–∞–≤–ª—è–µ—Ç –ø–∞—Ä—ã –¥–ª—è —Å–±–æ—Ä–∞ –º–µ—Ç—Ä–∏–∫. –ü–∞—Ä—ã –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ –ø—Ä–æ–±–µ–ª, –±–µ–∑ —É—á–µ—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞.

**–ü—Ä–∏–º–µ—Ä—ã:**
```
/coins BTCUSDT ETHUSDT
/coins btcusdt ethusdt
/coins BtcUsdt EthUsdt
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- –ü–∞—Ä—ã –Ω–æ—Ä–º–∞–ª–∏–∑—É—é—Ç—Å—è –≤ –≤–µ—Ä—Ö–Ω–∏–π —Ä–µ–≥–∏—Å—Ç—Ä
- –î—É–±–ª–∏–∫–∞—Ç—ã —É–¥–∞–ª—è—é—Ç—Å—è
- –†–µ–∑—É–ª—å—Ç–∏—Ä—É—é—â–∏–π —Å–ø–∏—Å–æ–∫ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ —Ñ–∞–π–ª `pairs.txt`
- –ë–æ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–∞—Ä

### `/data`
–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤ –≤ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ

### `/data export all`
–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –≤—Å–µ —Ñ–∞–π–ª—ã –≤ —á–∞—Ç

### `/data delete all`
–£–¥–∞–ª—è–µ—Ç –≤—Å–µ —Ñ–∞–π–ª—ã –∏–∑ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞

## –ú–æ–¥—É–ª—å metrics.py

–°–æ–¥–µ—Ä–∂–∏—Ç —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–ø–∏—Å–∫–æ–º —Ç–æ—Ä–≥–æ–≤—ã—Ö –ø–∞—Ä:

- `read_pairs(storage_dir)` - —á–∏—Ç–∞–µ—Ç –ø–∞—Ä—ã –∏–∑ `pairs.txt`
- `write_pairs(storage_dir, pairs)` - –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –ø–∞—Ä—ã –≤ `pairs.txt`
- `add_pairs(storage_dir, new_pairs)` - –¥–æ–±–∞–≤–ª—è–µ—Ç –Ω–æ–≤—ã–µ –ø–∞—Ä—ã
- `normalize_pair(pair)` - –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç –ø–∞—Ä—É (–≤–µ—Ä—Ö–Ω–∏–π —Ä–µ–≥–∏—Å—Ç—Ä)
- `parse_coins_command(command_text)` - –ø–∞—Ä—Å–∏—Ç –∫–æ–º–∞–Ω–¥—É `/coins`

## –§–∞–π–ª pairs.txt

–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ: `{DATA_STORAGE}/pairs.txt`

–§–æ—Ä–º–∞—Ç: –æ–¥–Ω–∞ –ø–∞—Ä–∞ –Ω–∞ —Å—Ç—Ä–æ–∫—É, –≤–µ—Ä—Ö–Ω–∏–π —Ä–µ–≥–∏—Å—Ç—Ä

**–ü—Ä–∏–º–µ—Ä:**
```
BTCUSDT
ETHUSDT
BNBUSDT
```

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

- **FastAPI** - –±—ã—Å—Ç—Ä—ã–π web framework
- **Uvicorn** - –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π ASGI —Å–µ—Ä–≤–µ—Ä
- **HTTPX** - –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π HTTP –∫–ª–∏–µ–Ω—Ç
- **metrics.py** - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞—Ä–∞–º–∏

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏ (–≤–µ—Ä—Å–∏—è 5.0)

- –ü–µ—Ä–µ–Ω–æ—Å –ª–æ–≥–∏–∫–∏ —Å–±–æ—Ä–∞ –º–µ—Ç—Ä–∏–∫ –∏–∑ —Å—Ç–∞—Ä–æ–≥–æ –±–æ—Ç–∞
- –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π —Å–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –ø–æ –ø–∞—Ä–∞–º —Å Binance API
- –†–∞—Å—á–µ—Ç —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ (SMA, ATR)
- –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä—ã–Ω–æ—á–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞ (Up/Down/Range)
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ –≤ JSON —Ñ–∞–π–ª—ã

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT
