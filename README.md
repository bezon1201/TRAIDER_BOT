# Telegram Bot - FastAPI Version 4.3

Telegram-–±–æ—Ç –Ω–∞ Python —Å FastAPI, Uvicorn –∏ –ø–æ–ª–Ω—ã–º —Å–±–æ—Ä–æ–º –º–µ—Ç—Ä–∏–∫ —Å —Ä–∞—Å—á–µ—Ç–æ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤

## –í–µ—Ä—Å–∏—è 4.3 (12.11.2025)

‚ú® **–ü–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å–±–æ—Ä–∞ –º–µ—Ç—Ä–∏–∫ –∫–∞–∫ –≤ —Å—Ç–∞—Ä–æ–º –±–æ—Ç–µ:**

- üìä –¢–∞–π–º—Ñ—Ä–µ–π–º—ã: **12h, 6h, 4h, 2h** (–∫–∞–∫ –≤ —Å—Ç–∞—Ä–æ–º –±–æ—Ç–µ)
- üìà –†–∞—Å—á–µ—Ç **SMA14** (Simple Moving Average –∑–∞ 14 –ø–µ—Ä–∏–æ–¥–æ–≤)
- üìä –†–∞—Å—á–µ—Ç **ATR14** (Average True Range –∑–∞ 14 –ø–µ—Ä–∏–æ–¥–æ–≤)
- üíæ –ú–µ—Ç—Ä–∏–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ JSON –¥–ª—è –∫–∞–∂–¥–æ–π –ø–∞—Ä—ã
- üîá –°–±–æ—Ä –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –º–æ–ª—á–∞ –±–µ–∑ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ Telegram

## –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞

### `/start`
–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ

### `/coins <pair1> <pair2> ...`
–î–æ–±–∞–≤–ª—è–µ—Ç –ø–∞—Ä—ã –¥–ª—è —Å–±–æ—Ä–∞ –º–µ—Ç—Ä–∏–∫

**–ü—Ä–∏–º–µ—Ä:**
```
/coins BTCUSDT ETHUSDT BNBUSDT
```

### `/now`
–°–æ–±–∏—Ä–∞–µ—Ç –º–µ—Ç—Ä–∏–∫–∏ –ø–æ –≤—Å–µ–º –ø–∞—Ä–∞–º (12h, 6h, 4h, 2h —Å SMA14 –∏ ATR14)

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
1. –ß–∏—Ç–∞–µ—Ç –ø–∞—Ä—ã –∏–∑ `pairs.txt`
2. –î–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–∞–π–º—Ñ—Ä–µ–π–º–∞ (12h, 6h, 4h, 2h):
   - –ó–∞–≥—Ä—É–∂–∞–µ—Ç 100 —Å–≤–µ—á–µ–π
   - –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç SMA14 (—Å–∫–æ–ª—å–∑—è—â–∞—è —Å—Ä–µ–¥–Ω—è—è 14 —Å–≤–µ—á–µ–π)
   - –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç ATR14 (—Å—Ä–µ–¥–Ω–∏–π –∏—Å—Ç–∏–Ω–Ω—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω 14 —Å–≤–µ—á–µ–π)
3. –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ JSON
4. **–ú–æ–ª—á–∞** (–±–µ–∑ —Å–æ–æ–±—â–µ–Ω–∏–π)

### `/data`
–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤ –≤ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ

### `/data export all`
–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –≤—Å–µ —Ñ–∞–π–ª—ã –≤ —á–∞—Ç

### `/data delete all`
–£–¥–∞–ª—è–µ—Ç –≤—Å–µ —Ñ–∞–π–ª—ã

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ JSON —Ñ–∞–π–ª–∞

**–ü—Ä–∏–º–µ—Ä BTCUSDT.json:**
```json
{
  "symbol": "BTCUSDT",
  "timestamp": "2025-12-12T06:34:00+00:00",
  "ticker": {
    "price": 42500.00,
    "bid_price": 42499.90,
    "ask_price": 42500.10,
    "high": 43000.00,
    "low": 42000.00,
    "volume": 15000.5,
    "trades": 500000
  },
  "timeframes": {
    "12h": {
      "klines": [...],
      "indicators": {
        "sma14": 42100.50,
        "atr14": 350.25
      }
    },
    "6h": {
      "klines": [...],
      "indicators": {
        "sma14": 42150.75,
        "atr14": 280.50
      }
    },
    "4h": {
      "klines": [...],
      "indicators": {
        "sma14": 42200.00,
        "atr14": 250.75
      }
    },
    "2h": {
      "klines": [...],
      "indicators": {
        "sma14": 42250.25,
        "atr14": 200.00
      }
    }
  }
}
```

## –ú–æ–¥—É–ª–∏

### `indicators.py`
–†–∞—Å—á–µ—Ç —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤:
- `calculate_sma(values, period)` - –ø—Ä–æ—Å—Ç–∞—è —Å–∫–æ–ª—å–∑—è—â–∞—è —Å—Ä–µ–¥–Ω—è—è
- `calculate_atr(highs, lows, closes, period)` - —Å—Ä–µ–¥–Ω–∏–π –∏—Å—Ç–∏–Ω–Ω—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω
- `extract_ohlcv_from_klines(klines)` - –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ OHLCV –∏–∑ —Å–≤–µ—á–µ–π
- `calculate_indicators(klines)` - —Ä–∞—Å—á–µ—Ç SMA14 –∏ ATR14

### `collector.py`
–°–±–æ—Ä –º–µ—Ç—Ä–∏–∫ —Å Binance:
- `fetch_ticker_price()` - —Ç–µ–∫—É—â–∞—è —Ü–µ–Ω–∞
- `fetch_klines()` - —Å–≤–µ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- `collect_metrics_for_symbol()` - –≤—Å–µ –º–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –æ–¥–Ω–æ–π –ø–∞—Ä—ã
- `collect_all_metrics()` - –º–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –≤—Å–µ—Ö –ø–∞—Ä

### `metrics.py`
–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞—Ä–∞–º–∏ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ

## –ü–æ—Ç–æ–∫ —Ä–∞–±–æ—Ç—ã

1. `/coins BTCUSDT ETHUSDT` ‚Äî –¥–æ–±–∞–≤–ª—è–µ—Ç –ø–∞—Ä—ã
2. `/now` ‚Äî —Å–æ–±–∏—Ä–∞–µ—Ç –º–µ—Ç—Ä–∏–∫–∏ (–º–æ–ª—á–∞)
3. JSON —Ñ–∞–π–ª—ã –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è: `BTCUSDT.json`, `ETHUSDT.json`
4. `/data export all` ‚Äî —Å–∫–∞—á–∞—Ç—å —Ñ–∞–π–ª—ã

## –î–µ–ø–ª–æ–π –Ω–∞ Render.com

- **Build Command**: `pip install -r requirements.txt`
- **Start Command**: `uvicorn main:app --host 0.0.0.0 --port $PORT`

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏ (–≤–µ—Ä—Å–∏—è 5.0)

- –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä—ã–Ω–æ—á–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞ (Up/Down/Range)
- –í—ã—á–∏—Å–ª–µ–Ω–∏–µ —Ç–æ—Ä–≥–æ–≤—ã—Ö —Ñ–ª–∞–≥–æ–≤
- –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–π —Å–±–æ—Ä –º–µ—Ç—Ä–∏–∫
- –ò—Å—Ç–æ—Ä–∏—è –º–µ—Ç—Ä–∏–∫

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT
