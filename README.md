# Trader Bot — версия 1.7

Телеграм-бот под деплой на Render, работающий через webhook.

## Что изменено в версии 1.7

- Команда `/now` теперь:
  - если файла `<SYMBOL>.json` **нет** — создаёт каркас (symbol, tf1, tf2, updated_ts, raw[TF1].candles/raw[TF2].candles пустые);
  - если файл **есть** — подтягивает с Binance Spot ~100 свечей для TF1 и TF2 и:
    - записывает их в `raw[TF1].candles` и `raw[TF2].candles`,
    - подрезает список до 100 элементов.
- Из структуры сырья убраны поля `ma30`, `ma90`, `atr14` — метрики будут считаться в отдельном модуле и храниться в `state`.
- Остальные команды (`/start`, `/help`, `/symbols`, `/data`) работают как в предыдущих версиях.

## История версий

- **1.7** — обновлённая команда `/now`, загрузка свечей с Binance и структура сырья только с `candles`.
- **1.6** — фиксы модуля `data.py`, стабильная работа `/data` на Render.
- **1.3–1.5** — команда `/data` и её доработки, импорт/экспорт/удаление файлов в STORAGE_DIR.
- **1.2** — команда `/now`, создание сырьевых файлов `<SYMBOL>.json`.
- **1.1** — команды `/help` и `/symbols`, файл `Bot_commands.txt`, работа с `symbols_list.json`.
- **1.0** — базовый скелет бота: FastAPI + webhook, health-check, уведомление админа о запуске.

## Переменные окружения

- `BOT_TOKEN` — токен Telegram-бота
- `ADMIN_CHAT_ID` — ID админского канала/чата
- `ADMIN_KEY` — ключ админа (в этой версии не используется)
- `BINANCE_API_KEY` — ключ Binance (не используется в 1.7)
- `BINANCE_API_SECRET` — секрет Binance (не используется в 1.7)
- `HTTP_PROXY` — HTTP-прокси (пока не используется)
- `HTTPS_PROXY` — HTTPS-прокси (пока не используется)
- `RAW_MAX_BYTES` — лимит размера raw-файлов (пока не используется)
- `STORAGE_DIR` — корень диска на Render для хранения state/raw-файлов
- `WEBHOOK_BASE` — публичный URL сервиса на Render без завершающего `/`
- `TF1` — старший таймфрейм
- `TF2` — младший таймфрейм
