# Telegram Bot - Python

Telegram-–±–æ—Ç –Ω–∞ Python —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π webhook, –ø—Ä–æ–∫—Å–∏, —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ —Ñ–∞–π–ª–æ–≤ –∏ —Ä–∞–∑–º–µ—â–µ–Ω–∏–µ–º –Ω–∞ Render.com

## –í–µ—Ä—Å–∏–∏

### v2.4 (12.11.2025)
- üêõ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ—à–∏–±–∫–∞ "NoneType object has no attribute 'bot'"
- ‚úÖ –ü–µ—Ä–µ–¥–µ–ª–∞–Ω–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –±–æ—Ç–∞
- üîÑ –ë–æ—Ç —Ç–µ–ø–µ—Ä—å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –ø–æ—Ç–æ–∫–µ –¥–æ –∑–∞–ø—É—Å–∫–∞ Flask
- üì° Webhook –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ asyncio.run_coroutine_threadsafe
- üîß –î–æ–±–∞–≤–ª–µ–Ω–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –º–µ–∂–¥—É Flask –∏ bot event loop

### v2.3 (12.11.2025)
- üêõ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ—à–∏–±–∫–∞ SyntaxError –Ω–∞ line 99 (unterminated f-string)
- ‚úÖ –£–¥–∞–ª–µ–Ω—ã –≤—Å–µ –º–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω—ã–µ f-strings - –∑–∞–º–µ–Ω–µ–Ω—ã –Ω–∞ –∫–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏—é —Å—Ç—Ä–æ–∫
- üìù –£–ø—Ä–æ—â–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –∫–æ–º–∞–Ω–¥–µ /data
- üîß –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω —Å–∏–Ω—Ç–∞–∫—Å–∏—Å –¥–ª—è Python 3.13

### v2.2 (12.11.2025)
- üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã webhook endpoints: –¥–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ `/tg` –∏ `/webhook`
- üì° –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `/tg` –∫–∞–∫ –æ—Å–Ω–æ–≤–Ω–æ–π webhook path
- ‚úÖ –£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
- üìù –î–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –≤—Å–µ—Ö webhook –∑–∞–ø—Ä–æ—Å–æ–≤

### v2.1 (12.11.2025)
- üêõ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –æ—à–∏–±–∫–∏ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞ –≤ main.py (unterminated f-string literals)
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –º–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω—ã—Ö f-—Å—Ç—Ä–æ–∫
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ ADMIN_CHAT_ID –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π —Å–æ–æ–±—â–µ–Ω–∏—è
- üîß –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –≤ –∫–æ–º–∞–Ω–¥–µ /data

### v2.0 (12.11.2025)
- ‚ú® –ù–æ–≤—ã–π –º–æ–¥—É–ª—å `data.py` –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ñ–∞–π–ª–∞–º–∏ –≤ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
- üìÅ –ö–æ–º–∞–Ω–¥–∞ `/data` - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤ (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)
- üì§ –ö–æ–º–∞–Ω–¥–∞ `/data export all` - –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –≤—Å–µ —Ñ–∞–π–ª—ã –≤ —á–∞—Ç
- üóëÔ∏è –ö–æ–º–∞–Ω–¥–∞ `/data delete all` - —É–¥–∞–ª—è–µ—Ç –≤—Å–µ —Ñ–∞–π–ª—ã –∏–∑ DATA_STORAGE
- üîß –ü–æ–¥–¥–µ—Ä–∂–∫–∞ Render Disk (–ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è DATA_STORAGE)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω root endpoint `/` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç–∞—Ç—É—Å–∞

### v1.0 (12.11.2025)
- ‚úÖ –ë–∞–∑–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–æ—Ç–∞ –Ω–∞ python-telegram-bot
- ‚úÖ Webhook –¥–ª—è —Ä–∞–±–æ—Ç—ã –Ω–∞ Render.com
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø—Ä–æ–∫—Å–∏ –¥–ª—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ IP (HTTP_PROXY, HTTPS_PROXY)
- ‚úÖ –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è "–ë–æ—Ç –∑–∞–ø—É—â–µ–Ω" –≤ admin chat –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
- ‚úÖ Health check endpoint `/health` –¥–ª—è UptimeRobot (HEAD/GET)
- ‚úÖ –ö–æ–º–∞–Ω–¥–∞ /start

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Python 3.9+
- –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ª–æ–∫–∞–ª—å–Ω–æ

1. –ö–ª–æ–Ω–∏—Ä—É–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:
```bash
git clone https://github.com/your-username/telegram-bot.git
cd telegram-bot
```

2. –£—Å—Ç–∞–Ω–æ–≤–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
```bash
pip install -r requirements.txt
```

3. –°–æ–∑–¥–∞–π —Ñ–∞–π–ª `.env` –∏ –∑–∞–ø–æ–ª–Ω–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ

4. –ó–∞–ø—É—Å—Ç–∏ –±–æ—Ç–∞:
```bash
python main.py
```

## –î–µ–ø–ª–æ–π –Ω–∞ Render.com

1. –°–æ–∑–¥–∞–π –Ω–æ–≤—ã–π **Web Service** –Ω–∞ [Render.com](https://render.com)
2. –ü–æ–¥–∫–ª—é—á–∏ GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
3. –ù–∞—Å—Ç—Ä–æ–π–∫–∏:
   - **Build Command**: `pip install -r requirements.txt`
   - **Start Command**: `gunicorn main:app --bind 0.0.0.0:$PORT`
4. –î–æ–±–∞–≤—å Environment Variables:
   - `BOT_TOKEN` - —Ç–æ–∫–µ–Ω Telegram –±–æ—Ç–∞
   - `ADMIN_CHAT_ID` - ID —á–∞—Ç–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
   - `WEBHOOK_BASE` - URL —Å–µ—Ä–≤–∏—Å–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä: `https://traider-bot.onrender.com`)
   - `HTTP_PROXY` –∏ `HTTPS_PROXY` - –¥–ª—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ IP (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
   - `DATA_STORAGE` - –ø—É—Ç—å –∫ Render Disk (–Ω–∞–ø—Ä–∏–º–µ—Ä: `/var/data`)

## Webhook –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

–ë–æ—Ç –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –¥–≤–∞ webhook endpoints:
- `/tg` - –æ—Å–Ω–æ–≤–Ω–æ–π path (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- `/webhook` - –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π path

Webhook —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –±–æ—Ç–∞ –Ω–∞ –ø—É—Ç—å `/tg`.

## UptimeRobot –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

1. –°–æ–∑–¥–∞–π –Ω–æ–≤—ã–π –º–æ–Ω–∏—Ç–æ—Ä –Ω–∞ [UptimeRobot.com](https://uptimerobot.com)
2. –¢–∏–ø: **HTTP(s)** –∏–ª–∏ **HEAD**
3. URL: `https://your-app.onrender.com/health`
4. –ò–Ω—Ç–µ—Ä–≤–∞–ª –ø—Ä–æ–≤–µ—Ä–∫–∏: 5 –º–∏–Ω—É—Ç

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
.
‚îú‚îÄ‚îÄ main.py              # –û—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª –±–æ—Ç–∞ —Å –∫–æ–º–∞–Ω–¥–∞–º–∏
‚îú‚îÄ‚îÄ data.py              # –ú–æ–¥—É–ª—å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ñ–∞–π–ª–∞–º–∏
‚îú‚îÄ‚îÄ requirements.txt     # Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îî‚îÄ‚îÄ README.md           # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

## Endpoints

- `/health` - Health check –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ (HEAD/GET)
- `/` - Root endpoint (GET/HEAD)
- `/webhook` - Webhook endpoint –¥–ª—è Telegram (POST)
- `/tg` - –û—Å–Ω–æ–≤–Ω–æ–π webhook endpoint (POST)

## –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞

- `/start` - –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
- `/data` - –ü–æ–∫–∞–∑–∞—Ç—å —Å–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤ –≤ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
- `/data export all` - –û—Ç–ø—Ä–∞–≤–∏—Ç—å –≤—Å–µ —Ñ–∞–π–ª—ã –≤ –∞–∫—Ç–∏–≤–Ω—ã–π —á–∞—Ç
- `/data delete all` - –£–¥–∞–ª–∏—Ç—å –≤—Å–µ —Ñ–∞–π–ª—ã –∏–∑ DATA_STORAGE

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –º–æ–¥—É–ª—è data.py

```python
from data import DataStorage

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
storage = DataStorage('/path/to/storage')

# –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤
files = storage.get_files_list()

# –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ñ–∞–π–ª
storage.save_file('myfile.txt', b'content')

# –ü–æ–ª—É—á–∏—Ç—å –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É
path = storage.get_file_path('myfile.txt')

# –£–¥–∞–ª–∏—Ç—å –≤—Å–µ —Ñ–∞–π–ª—ã
storage.delete_all()

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞
exists = storage.file_exists('myfile.txt')

# –ü–æ–ª—É—á–∏—Ç—å —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞
size = storage.get_file_size('myfile.txt')
```

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ v2.4

–í –≤–µ—Ä—Å–∏–∏ 2.4 –±—ã–ª–∞ –ø–µ—Ä–µ–¥–µ–ª–∞–Ω–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –¥–ª—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º—ã —Å NoneType:

1. **Bot Thread** - –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç –±–æ—Ç–∞ –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –ø–æ—Ç–æ–∫–µ —Å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–º event loop
2. **Flask Thread** - –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –ø–æ—Ç–æ–∫–µ –ø–æ—Å–ª–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –±–æ—Ç–∞
3. **Webhook Handler** - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `asyncio.run_coroutine_threadsafe()` –¥–ª—è –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏ –º–µ–∂–¥—É –ø–æ—Ç–æ–∫–∞–º–∏

## –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –ë–æ—Ç –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
- –ü—Ä–æ–≤–µ—Ä—å, —á—Ç–æ `BOT_TOKEN` –∏ `WEBHOOK_BASE` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- –£–±–µ–¥–∏—Å—å, —á—Ç–æ webhook —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π path (`/tg` –∏–ª–∏ `/webhook`)
- –ü—Ä–æ–≤–µ—Ä—å –ª–æ–≥–∏ Render.com –¥–ª—è –æ—à–∏–±–æ–∫

### Error: 'NoneType' object has no attribute 'bot'
- –≠—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ v2.4
- –£–±–µ–¥–∏—Å—å, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—à—å –ø–æ—Å–ª–µ–¥–Ω—é—é –≤–µ—Ä—Å–∏—é main.py

### 404 –Ω–∞ webhook endpoints
- –£–±–µ–¥–∏—Å—å, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π path (`/tg` –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- –ü—Ä–æ–≤–µ—Ä—å, —á—Ç–æ WEBHOOK_BASE –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç `/tg` –≤ –∫–æ–Ω—Ü–µ

### –°–æ–æ–±—â–µ–Ω–∏–µ "–ë–æ—Ç –∑–∞–ø—É—â–µ–Ω" –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è
- –£–±–µ–¥–∏—Å—å, —á—Ç–æ `ADMIN_CHAT_ID` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- –ü—Ä–æ–≤–µ—Ä—å, —á—Ç–æ –±–æ—Ç –∏–º–µ–µ—Ç –ø—Ä–∞–≤–∞ –Ω–∞ –æ—Ç–ø—Ä–∞–≤–∫—É —Å–æ–æ–±—â–µ–Ω–∏–π

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Binance API
- –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –¥–ª—è –º–µ—Ç—Ä–∏–∫ –∏ —Ä–∞—Å—á—ë—Ç–æ–≤
- –•—Ä–∞–Ω–∏–ª–∏—â–µ –¥–∞–Ω–Ω—ã—Ö –≤ –ë–î
- –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞ –±–æ—Ç–∞

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT
